<!DOCTYPE html>
<html>
<head> 
<meta charset="utf-8"> 
<title>try</title> 
<script src="jquery-3.4.1.min.js"></script>
<!--图标样式-->
<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
<!--主要样式-->
<link rel="stylesheet" type="text/css" href="css/style.css" />
<script type="text/javascript">

$(function(){

    $('.tree li:has(ul)').addClass('parent_li').find(' > span').attr('title', 'Collapse this branch');

    $('.tree li.parent_li > span').on('click', function (e) {

        var children = $(this).parent('li.parent_li').find(' > ul > li');

        if (children.is(":visible")) {

            children.hide('fast');

            $(this).attr('title', 'Expand this branch').find(' > i').addClass('icon-plus-sign').removeClass('icon-minus-sign');

        } else {

            children.show('fast');

            $(this).attr('title', 'Collapse this branch').find(' > i').addClass('icon-minus-sign').removeClass('icon-plus-sign');

        }

        e.stopPropagation();

    });

});

</script>
</head>

<body>
<textarea id="text1" type="text" rows="10" cols="30"></textarea>
<button>确定</button>
<script>
$(function(){	
	$("button").on('click',function(){
   		var s =document.getElementById("text1").value;
		var reg = new RegExp("导师：","g");
		s.replace(reg,"导师：/");
		var reg = new RegExp("级博士生：","g");
		s.replace(reg,"级博士生：/");
		var reg = new RegExp("级硕士生：","g");
		s.replace(reg,"级硕士生：/");
		var reg = new RegExp("级本科生：","g");
		s.replace(reg,"级本科生：/");
   		var ss = s.split(/、|\n|\r|：/g); //  /导师：|级博士生：|级硕士生：|级本科生：|、|\n|\r/g
		console.log(ss);
		var i;
		var num1=0;
		var num2=1000;
		for(i=0;i<ss.length;i++){
			if(ss[i]=="导师"){
				$("#tree").after('<ul><li><span id="teacher" class="badge badge-success"> 导师</span></li></u1>');
			}
			else{
				if(ss[i].match(/(([0-9]+)级博士生)|(([0-9]+)级硕士生)|(([0-9]+)级本科生)/)){
					break;
				}
				$("#teacher").after('<ul><li><span id=teachername> </span></li></u1>');
				$("#teachername").html(ss[i]);
			} 
		}
		
		while(i<ss.length){
			if(ss[i].match(/([0-9]+)级博士生/)){
				/*var element=document.createElement("span");
				element.setAttribute("id","element"+i);
				document.body.appendChild(element);
				element.appendChild(document.createTextNode(ss[i])); */
				$("#tree").after('<ul><li><span id="id'+num1+'" class="badge badge-success"> </span></li></u1>');
				$('#id'+num1).html(ss[i]);
				//var q=$(".1").attr("id");
				console.log(i);
				i++;
				for(;i<ss.length;i++){
					if(ss[i].match(/(([0-9]+)级博士生)|(([0-9]+)级硕士生)|(([0-9]+)级本科生)/)){
						i--;
						break;
					}
					$('#id'+num1).after('<ul><li><span id="id'+num2+'"> </span></li></u1>');
					//$("#tree").after('<ul><li><span id="id'+num1+'" class="1"> </span></li></u1>');
					//$('#id'+num1).html(ss[i]);
					//var q=$(".1").attr("id");
					//console.log(q);
					$('#id'+num2).html(ss[i]);
					num2=num2+1;
					console.log(i);
				}  
				num1=num1+1;
			}
			else{
				break;
			}
			i++;
			console.log(i);
		}
		
		while(i<ss.length){
			if(ss[i].match(/([0-9]+)级硕士生/)){
				$("#tree").after('<ul><li><span id="id'+num1+'" class="badge badge-success"> </span></li></u1>');
				$('#id'+num1).html(ss[i]);
				//var q=$(".1").attr("id");
				//console.log(i);
				i++;
				for(;i<ss.length;i++){
					if(ss[i].match(/(([0-9]+)级博士生)|(([0-9]+)级硕士生)|(([0-9]+)级本科生)/)){
						i--;
						break;
					}
					$('#id'+num1).after('<ul><li><span id="id'+num2+'"> </span></li></u1>');
					//$("#tree").after('<ul><li><span id="id'+num1+'" class="1"> </span></li></u1>');
					//$('#id'+num1).html(ss[i]);
					//var q=$(".1").attr("id");
					//console.log(q);
					$('#id'+num2).html(ss[i]);
					num2=num2+1;
					//console.log(i);
				}  
				num1=num1+1;
			}
			else{
				break;
			}
			i++;
			//console.log(i);
		} 
		
		while(i<ss.length){
			if(ss[i].match(/([0-9]+)级本科生/)){
				$("#tree").after('<ul><li><span id="id'+num1+'" class="badge badge-success"> </span></li></u1>');
				$('#id'+num1).html(ss[i]);
				//var q=$(".1").attr("id");
				//console.log(i);
				i++;
				for(;i<ss.length;i++){
					if(ss[i].match(/(([0-9]+)级博士生)|(([0-9]+)级硕士生)|(([0-9]+)级本科生)/)){
						i--;
						break;
					}
					$('#id'+num1).after('<ul><li><span id="id'+num2+'"> </span></li></u1>');
					//$("#tree").after('<ul><li><span id="id'+num1+'" class="1"> </span></li></u1>');
					//$('#id'+num1).html(ss[i]);
					//var q=$(".1").attr("id");
					//console.log(q);
					$('#id'+num2).html(ss[i]);
					num2=num2+1;
					//console.log(i);
				}  
				num1=num1+1;
			}
			else{
				break;
			}
			i++;
			//console.log(i);
		} 
		//var myJSON = JSON.stringify(ss);
				
		//$("#teacher").html(ss[1]);
		//$("#master1").html(ss[2]+"级硕士生");
		
	});
});
	
</script>

<div class="tree">

    <ul>

        <li>

            <span id="tree"> 学术家族树</span>
            
            
        </li>
        
    </ul>
    
</div>

</body>
</html>